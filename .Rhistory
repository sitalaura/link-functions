plot.subtitle = element_text(size = 18),
axis.title = element_text(size = 18),
axis.text = element_text(size = 14)
)
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
library(mafc)   # assicurati che sia caricato
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
# curva logistica
df_line <- data.frame(
x = seq(-4.5, 4.5, length.out = 400)
)
df_line$y <- plogis(df_line$x)
# valori discreti sul predittore lineare
x_vals <- -4:4
y_vals <- plogis(x_vals)
ggplot(df_line, aes(x = x, y = y)) +
# linee orizzontali (probabilità NON equispaziate)
geom_hline(
yintercept = y_vals,
color = "grey60",
linewidth = 0.6
) +
# linee verticali (x equispaziate)
geom_vline(
xintercept = x_vals,
color = "red",
linetype = "dashed",
linewidth = 0.6
) +
# curva logit
geom_line(
color = "blue",
linewidth = 2
) +
scale_x_continuous(
limits = c(-4.5, 4.5),
breaks = x_vals
) +
scale_y_continuous(
limits = c(0, 1),
breaks = round(y_vals, 2),
labels = round(y_vals, 2)
) +
labs(
x = "X values (linear predictor)",
y = "Probability / Accuracy"
) +
theme_minimal(base_size = 18) +
theme(
axis.title = element_text(size = 18),
axis.text = element_text(size = 14)
)
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
# curva della link (solo X positivi)
df_line <- data.frame(
x = seq(0, 4.5, length.out = 300)
)
df_line$y <- pnorm(df_line$x / 2)   # equivalente a mafc.probit(.m = 2)$linkinv
# valori discreti del predittore lineare (solo positivi)
x_vals <- 0:4
y_vals <- pnorm(x_vals / 2)
ggplot(df_line, aes(x = x, y = y)) +
# linee orizzontali (probabilità non equispaziate)
geom_hline(
yintercept = y_vals,
color = "grey60",
linewidth = 0.6
) +
# linee verticali (x equispaziate)
geom_vline(
xintercept = x_vals,
color = "red",
linetype = "dashed",
linewidth = 0.6
) +
# curva probit MAFC
geom_line(
color = "blue",
linewidth = 2
) +
scale_x_continuous(
limits = c(0, 4.5),
breaks = x_vals
) +
scale_y_continuous(
limits = c(0.5, 1),
breaks = round(y_vals, 2),
labels = round(y_vals, 2)
) +
labs(
x = "X values (linear predictor)",
y = "Accuracy"
) +
theme_minimal(base_size = 18) +
theme(
plot.title = element_text(face = "bold", color = "steelblue", size = 26),
plot.subtitle = element_text(size = 18),
axis.title = element_text(size = 18),
axis.text = element_text(size = 14)
)
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
# curva link
df_line <- data.frame(
x = seq(-4.5, 4.5, length.out = 400)
)
df_line$y <- pnorm(df_line$x / 2)   # equivalente a mafc.probit(.m = 2)$linkinv
x_vals <- -4:4
y_vals <- pnorm(x_vals / 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(
yintercept = y_vals,
color = "grey60",
linewidth = 0.6
) +
geom_vline(
xintercept = x_vals,
color = "red",
linetype = "dashed",
linewidth = 0.6
) +
geom_line(
color = "blue",
linewidth = 2
) +
scale_x_continuous(
limits = c(-4.5, 4.5),
breaks = x_vals
) +
scale_y_continuous(
limits = c(0, 1),
breaks = round(y_vals, 2),
labels = round(y_vals, 2)
) +
labs(
title = "link = mafc.probit(.m = 2)",
subtitle = "equal intervals on X do NOT correspond to equal intervals on Y",
x = "X values (linear predictor)",
y = "Probability / Accuracy"
) +
theme_minimal(base_size = 18) +
theme(
plot.title = element_text(face = "bold", color = "steelblue", size = 26),
plot.subtitle = element_text(size = 18),
axis.title = element_text(size = 18),
axis.text = element_text(size = 14)
)
#| echo: false
#| warning: false
#| fig.align: "center"
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
# linea esplicita del chance level (qui = 0.5)
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(limits = c(0, 1), breaks = round(y_vals, 2), labels = round(y_vals, 2)) +
labs(title = "link = mafc.probit(2)", x = "X values (linear predictor)", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
# linea esplicita del chance level (qui = 0.5)
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(limits = c(0, 1), breaks = round(y_vals, 2), labels = round(y_vals, 2)) +
labs(ìx = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
# linea esplicita del chance level (qui = 0.5)
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(limits = c(0, 1), breaks = round(y_vals, 2), labels = round(y_vals, 2)) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(limits = c(0.4, 1), breaks = round(y_vals, 2), labels = round(y_vals, 2)) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(
limits = c(0.25, 1),
breaks = round(y_vals, 2),
labels = round(y_vals, 2),
guide = guide_axis(n.dodge = 2)
) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
y_breaks <- round(y_vals, 2)
y_breaks <- y_breaks[c(TRUE, FALSE)]
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(
yintercept = y_vals,
color = "grey60",
linewidth = 0.6
) +
geom_vline(
xintercept = x_vals,
color = "red",
linetype = "dashed",
linewidth = 0.6
) +
geom_line(
color = "blue",
linewidth = 2
) +
geom_hline(
yintercept = 1/2,
linewidth = 1
) +
scale_x_continuous(
limits = c(-4.5, 4.5),
breaks = x_vals
) +
scale_y_continuous(
limits = c(0.25, 1),
breaks = y_breaks,
labels = y_breaks
) +
labs(
x = "Linear component of the model",
y = "Accuracy"
) +
theme_minimal(base_size = 18) +
theme(
axis.title = element_text(size = 18),
axis.text = element_text(size = 14)
)
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(
limits = c(0.25, 1),
breaks = round(y_vals, 2),
labels = round(y_vals, 2),
guide = guide_axis(n.dodge = 2)   # <- SOLUZIONE 1
) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
y_breaks <- mafc_probit_linkinv(c(-4, 0, 1, 2, 3, 4), m = 2)
y_breaks <- round(y_breaks, 2)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(
limits = c(0.25, 1),
breaks = y_breaks,          # SOLO queste etichette
labels = y_breaks
) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
library(ggplot2)
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
# etichetto solo alcuni livelli (come prima), ma EVITO "1"
y_breaks <- mafc_probit_linkinv(c(-4, 0, 1, 2, 3, 4), m = 2)
y_breaks <- round(y_breaks, 2)
# rimuove 1 (se presente) e aggiunge 0.99 (opzionale)
y_breaks <- y_breaks[y_breaks < 1]
y_breaks <- c(y_breaks, 0.99)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(
limits = c(0.25, 1),
breaks = y_breaks,
labels = y_breaks
) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| warning: false
#| fig.align: "center"
mafc_probit_linkinv <- function(x, m) {
g <- 1 / m
g + (1 - g) * pnorm(x)
}
df_line <- data.frame(x = seq(-4.5, 4.5, length.out = 400))
df_line$y <- mafc_probit_linkinv(df_line$x, m = 2)
x_vals <- -4:4
y_vals <- mafc_probit_linkinv(x_vals, m = 2)
y_breaks <- mafc_probit_linkinv(c(-4, -1, 0, 1, 2, 3, 4), m = 2)
y_breaks <- round(y_breaks, 2)
y_breaks <- y_breaks[y_breaks < 1]
y_breaks <- c(y_breaks, 0.99)
ggplot(df_line, aes(x = x, y = y)) +
geom_hline(yintercept = y_vals, color = "grey60", linewidth = 0.6) +
geom_vline(xintercept = x_vals, color = "red", linetype = "dashed", linewidth = 0.6) +
geom_line(color = "blue", linewidth = 2) +
geom_hline(yintercept = 1/2, linewidth = 1) +
scale_x_continuous(limits = c(-4.5, 4.5), breaks = x_vals) +
scale_y_continuous(
limits = c(0.25, 1),
breaks = y_breaks,
labels = y_breaks
) +
labs(x = "Linear component of the model", y = "Accuracy") +
theme_minimal(base_size = 18) +
theme(axis.title = element_text(size = 18), axis.text = element_text(size = 14))
#| echo: false
#| include: false
#source("R/datasim.R")
library(ggplot2)
library(effects)
library(psyphy)
ts <- 16
tc <- "black"
#| echo: false
set.seed(2)
N <- 200
age <- runif(N, 6, 10)
r <- 0.7
age_z <- scale(age)
y <- r * age_z + sqrt(1 - r^2) * rnorm(N)
d <- data.frame(age, y)
ggplot(d,aes(x=age,y=y))+
geom_point()
#| echo: true
#| eval: false
fit = lm(y~age, data=d)
#| echo: false
fit = lm(y~age, data=d)
eff = data.frame(allEffects(fit,xlevels=list(age=seq(6,10,.1)))$"age")
eff$accuracy = eff$fit
ggplot(d,aes(x=age,y=accuracy))+
geom_point()+
geom_line(data=eff,color="red",size=2)
#| echo: false
fit = lm(y~age, data=d)
eff = data.frame(allEffects(fit,xlevels=list(age=seq(6,10,.1)))$"age")
eff$accuracy = eff$fit
ggplot(d,aes(x=age,y=y))+
geom_point()+
geom_line(data=eff,color="red",size=2)
#| echo: false
fit = lm(y~age, data=d)
ggplot(d,aes(x=age,y=y))+
geom_point()+
geom_line(data=eff,color="red",size=2)
#| echo: false
eff <- data.frame(age = seq(min(age), max(age), length.out = 100))
fit <- lm(y ~ age, data = d)
eff$y <- predict(fit, newdata = eff)
ggplot(d, aes(x = age, y = y)) +
geom_point(alpha = .6) +
geom_line(data = eff, aes(x = age, y = y),
color = "red", linewidth = 2)
library(renderthis)
getwd
getwd()
renderthis::to_pdf("/Users/laura/Desktop/GITHUB/link-functions")
renderthis::to_pdf("/Users/laura/Desktop/GITHUB/link-functions.qmd")
renderthis::to_pdf("/Users/laura/Desktop/GITHUB/link-functions.qmd")
renderthis::to_pdf("/Users/laura/Desktop/GITHUB/link-functions/link-functions.qmd")
mean(d$iq_score)
sd(d$iq_score)
cor(d$age, d$iq_score)
#| echo: false
set.seed(2)
N <- 200
age <- runif(N, 6, 10)
r <- 0.7
age_z <- scale(age)
iq_std <- r * age_z + sqrt(1 - r^2) * rnorm(N)
iq_score <- 100 + 15 * as.numeric(iq_std)
d <- data.frame(age, iq_score)
ggplot(d,aes(x=age,y=iq_score))+
geom_point()+
ylab("IQ score")
mean(d$iq_score)
sd(d$iq_score)
cor(d$age, d$iq_score)
